angular.module('sntApp').controller('RegionalDetailRecipeCtrl', function ($cookieStore,$scope, $state, $rootScope, $stateParams, AuthService, toaster, POPTIMEOUT,$uibModal,$timeout) {
    function DateDiff(a,b){var c,d,e,f;return c=a.split("-"),d=new Date(c[1]+"-"+c[2]+"-"+c[0]),c=b.split("-"),e=new Date(c[1]+"-"+c[2]+"-"+c[0]),f=parseInt(Math.abs(d-e)/1e3/60/60/24)}function getNewDay(a,b){var c,d,e,f,g,h;return a=a.split("-"),c=new Date(a[1]+"-"+a[2]+"-"+a[0]),d=Math.abs(c)+1e3*60*60*24*b,e=new Date(d),f=e.getFullYear(),g=e.getMonth()+1,10>g&&(g="0"+g),h=e.getDate(),10>h&&(h="0"+h),f+"-"+g+"-"+h}$scope.format=function(a,b){var c=new Date(a),d=function(a){return(10>a?"0":"")+a};return b.replace(/yyyy|MM|dd|HH|mm|ss/g,function(a){switch(a){case"yyyy":return d(c.getUTCFullYear());break;case"MM":return d(c.getUTCMonth()+1);break;case"mm":return d(c.getUTCMinutes());break;case"dd":return d(c.getUTCDate());break;case"HH":return d(c.getUTCHours());break;case"ss":return d(c.getUTCSeconds())}})},Date.prototype.Format=function(a){var c,b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a};
    var regionId,gatewayId,token,dataBase,queryRegionRecipe;$scope.regionName=$stateParams.regionName,regionId=$stateParams.regionId,gatewayId=$stateParams.gatewayId,token=$cookieStore.get("token"),dataBase=openDatabase("sensorData","1.0","sensorDataTable",1073741824),$scope.delay=0,$scope.minDuration=0,$scope.message="",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/custom-chartload-template.html",$scope.recipeDetail=!1,queryRegionRecipe={region_guid:regionId},$scope.regionRecipeProm=AuthService.myHttp(token,queryRegionRecipe,"GET","recipe/regionRecipe").then(function(a){var c,b=[];if(a.content)for($scope.device_guid=a.content[0].device_guid,$scope.RegionRecipeList=[],c=0;c<a.content.length;c++)$scope.RegionRecipeList[c]={},$scope.RegionRecipeList[c].period=""+a.content[c].days.length,$scope.RegionRecipeList[c].name=a.content[c].name,$scope.RegionRecipeList[c].private_recipe_id=a.content[c].private_recipe_id,$scope.RegionRecipeList[c].seq=a.content[c].seq,b[c]=new Date(a.content[c].start_time),$scope.RegionRecipeList[c].start_time=b[c].getTime(),$scope.RegionRecipeList[c].start_time-=1e3*60*(new Date).getTimezoneOffset(),$scope.RegionRecipeList[c].start_time=new Date($scope.RegionRecipeList[c].start_time).Format("yyyy-MM-dd hh:mm:ss"),$scope.RegionRecipeList[c].status=a.content[c].status}),$scope.my={},$scope.findStandard=[{name:"Week",timeDiff:"168",pointDiff:"48",dayDiff:"7"},{name:"Month",timeDiff:"720",pointDiff:"48",dayDiff:"30"},{name:"Quarter",timeDiff:"2160",pointDiff:"16",dayDiff:"90"},{name:"HalfYear",timeDiff:"4320",pointDiff:"8",dayDiff:"180"},{name:"Year",timeDiff:"8640",pointDiff:"4",dayDiff:"360"}],$scope.my.name=$scope.findStandard[0],$scope.my.standard=$scope.findStandard[0].name,$scope.my.timeDiff=$scope.findStandard[0].timeDiff,$scope.my.dayDiff=$scope.findStandard[0].dayDiff,$scope.my.pointDiff=$scope.findStandard[0].pointDiff,$scope.recipe_start_time="";


    $scope.showRecipeDetail=function(a){var b,c,d,e;toaster.pop({type:"success",title:"Hint",body:"Please waiting ...",timeout:POPTIMEOUT}),$scope.recipe_start_time=a.start_time,$scope.default_endTime=new Date,b="",c="",$scope.default_endTime=new Date(new Date($scope.default_endTime.getTime()-864e5).Format("yyyy-MM-dd hh:mm:ss").substring(0,10)+" 23:59:59").Format("yyyy-MM-dd hh:mm:ss"),d=$scope.default_endTime,$scope.default_startTime=new Date(new Date($scope.default_endTime).getTime()-1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),b=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),c=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),e={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:b,end_time:c,days:$scope.my.dayDiff},$scope.recipeDetail=!0,AuthService.myHttp(token,e,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT}),$scope.recipeDetail=!1}),$scope.last=function(){if($scope.default_startTime<=$scope.recipe_start_time)toaster.pop({type:"error",title:"Error",body:"There is no earlier data !",timeout:POPTIMEOUT});else{toaster.pop({type:"success",title:"Hint",body:"Please waiting ...",timeout:POPTIMEOUT}),$scope.default_endTime=$scope.default_startTime,$scope.default_startTime=new Date(new Date($scope.default_startTime).getTime()-1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),b=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),c=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss");var a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:b,end_time:c,days:$scope.my.dayDiff};AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);
            for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})}},$scope.next=function(){if(d<=$scope.default_endTime)toaster.pop({type:"error",title:"Error",body:"There is no more data !",timeout:POPTIMEOUT});else{toaster.pop({type:"success",title:"Hint",body:"Please waiting ...",timeout:POPTIMEOUT}),$scope.default_startTime=$scope.default_endTime,$scope.default_endTime=new Date(new Date($scope.default_endTime).getTime()+1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),b=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),c=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss");var a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:b,end_time:c,days:$scope.my.dayDiff};AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);
            for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})}}};

    $scope.findRecipeData = function () {
        toaster.pop({type: 'success', title: 'Hint', body: 'Please waiting ...', timeout: POPTIMEOUT});
        $scope.my.standard = $scope.my.name.name;$scope.my.timeDiff = $scope.my.name.timeDiff;$scope.my.dayDiff = $scope.my.name.dayDiff;$scope.my.pointDiff = $scope.my.name.pointDiff;$scope.default_endTime = new Date();
        var UTC_startTime = '';var UTC_endTime = '';
        if($scope.my.standard == 'Week' || $scope.my.standard == 'Month'){
            $scope.default_endTime = new Date((new Date($scope.default_endTime.getTime() - 24*60*60*1000).Format("yyyy-MM-dd hh:mm:ss")).substring(0,10) + ' 23:59:59').Format('yyyy-MM-dd hh:mm:ss');
            var current_time = $scope.default_endTime;
            $scope.default_startTime = new Date(new Date($scope.default_endTime).getTime() - $scope.my.timeDiff*60*60*1000).Format('yyyy-MM-dd hh:mm:ss');
            UTC_startTime = $scope.format(new Date($scope.default_startTime).toUTCString(), 'yyyy-MM-dd HH:mm:ss');
            UTC_endTime = $scope.format(new Date($scope.default_endTime).toUTCString(), 'yyyy-MM-dd HH:mm:ss');
            var getRecipeData = {'region_guid' : regionId, 'gateway_id' : gatewayId, 'size' : $scope.my.pointDiff, 'start_time' : UTC_startTime, 'end_time' : UTC_endTime, 'days' : $scope.my.dayDiff}
            var getRecipeDataProm=AuthService.myHttp(token,getRecipeData,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})});
        }
        else if($scope.my.standard == 'Quarter'){
            $scope.default_endTime = new Date((new Date($scope.default_endTime.getTime() - 24*60*60*1000).Format("yyyy-MM-dd hh:mm:ss")).substring(0,10) + ' 23:59:59').Format('yyyy-MM-dd hh:mm:ss');
            var current_time = $scope.default_endTime;
            $scope.default_startTime = new Date(new Date($scope.default_endTime).getTime() - $scope.my.timeDiff*60*60*1000).Format('yyyy-MM-dd hh:mm:ss');
            UTC_startTime = $scope.format(new Date($scope.default_startTime).toUTCString(), 'yyyy-MM-dd HH:mm:ss');
            UTC_endTime = $scope.format(new Date($scope.default_endTime).toUTCString(), 'yyyy-MM-dd HH:mm:ss');
            var getRecipeData = {'region_guid' : regionId, 'gateway_id' : gatewayId, 'size' : $scope.my.pointDiff, 'start_time' : UTC_startTime, 'end_time' : UTC_endTime, 'days' : $scope.my.dayDiff}
            var getRecipeDataProm=AuthService.myHttp(token,getRecipeData,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorQuarterDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorQuarterDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})});
        }else if($scope.my.standard == 'HalfYear'){
            $scope.default_endTime = new Date((new Date($scope.default_endTime.getTime() - 24*60*60*1000).Format("yyyy-MM-dd hh:mm:ss")).substring(0,10) + ' 23:59:59').Format('yyyy-MM-dd hh:mm:ss');
            var current_time = $scope.default_endTime;
            $scope.default_startTime = new Date(new Date($scope.default_endTime).getTime() - $scope.my.timeDiff*60*60*1000).Format('yyyy-MM-dd hh:mm:ss');
            UTC_startTime = $scope.format(new Date($scope.default_startTime).toUTCString(), 'yyyy-MM-dd HH:mm:ss');
            UTC_endTime = $scope.format(new Date($scope.default_endTime).toUTCString(), 'yyyy-MM-dd HH:mm:ss');
            var getRecipeData = {'region_guid' : regionId, 'gateway_id' : gatewayId, 'size' : $scope.my.pointDiff, 'start_time' : UTC_startTime, 'end_time' : UTC_endTime, 'days' : $scope.my.dayDiff}
            var getRecipeDataProm=AuthService.myHttp(token,getRecipeData,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorHalfYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorHalfYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})});
        }else {
            $scope.default_endTime = new Date((new Date($scope.default_endTime.getTime() - 24*60*60*1000).Format("yyyy-MM-dd hh:mm:ss")).substring(0,10) + ' 23:59:59').Format('yyyy-MM-dd hh:mm:ss');
            var current_time = $scope.default_endTime;
            $scope.default_startTime = new Date(new Date($scope.default_endTime).getTime() - $scope.my.timeDiff*60*60*1000).Format('yyyy-MM-dd hh:mm:ss');
            UTC_startTime = $scope.format(new Date($scope.default_startTime).toUTCString(), 'yyyy-MM-dd HH:mm:ss');
            UTC_endTime = $scope.format(new Date($scope.default_endTime).toUTCString(), 'yyyy-MM-dd HH:mm:ss');
            var getRecipeData = {'region_guid' : regionId, 'gateway_id' : gatewayId, 'size' : $scope.my.pointDiff, 'start_time' : UTC_startTime, 'end_time' : UTC_endTime, 'days' : $scope.my.dayDiff}
            var getRecipeDataProm=AuthService.myHttp(token,getRecipeData,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})});
        }

        $scope.last=function(){var a;$scope.default_startTime<=$scope.recipe_start_time?toaster.pop({type:"error",title:"Error",body:"There is no earlier data !",timeout:POPTIMEOUT}):(toaster.pop({type:"success",title:"Hint",body:"Please waiting ...",timeout:POPTIMEOUT}),"Week"==$scope.my.standard||"Month"==$scope.my.standard?($scope.default_endTime=$scope.default_startTime,$scope.default_startTime=new Date(new Date($scope.default_startTime).getTime()-1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),UTC_startTime=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),UTC_endTime=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:UTC_startTime,end_time:UTC_endTime,days:$scope.my.dayDiff},AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})):"Quarter"==$scope.my.standard?($scope.default_endTime=$scope.default_startTime,$scope.default_startTime=new Date(new Date($scope.default_startTime).getTime()-1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),UTC_startTime=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),UTC_endTime=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:UTC_startTime,end_time:UTC_endTime,days:$scope.my.dayDiff},AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);
                for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorQuarterDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorQuarterDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})):"HalfYear"==$scope.my.standard?($scope.default_endTime=$scope.default_startTime,$scope.default_startTime=new Date(new Date($scope.default_startTime).getTime()-1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),UTC_startTime=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),UTC_endTime=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:UTC_startTime,end_time:UTC_endTime,days:$scope.my.dayDiff},AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);
                for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorHalfYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorHalfYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})):($scope.default_endTime=$scope.default_startTime,$scope.default_startTime=new Date(new Date($scope.default_startTime).getTime()-1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),UTC_startTime=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),UTC_endTime=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:UTC_startTime,end_time:UTC_endTime,days:$scope.my.dayDiff},AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));
            r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})))};

        $scope.next=function(){var a;current_time<=$scope.default_endTime?toaster.pop({type:"error",title:"Error",body:"There is no more data !",timeout:POPTIMEOUT}):(toaster.pop({type:"success",title:"Hint",body:"Please waiting ...",timeout:POPTIMEOUT}),"Week"==$scope.my.standard||"Month"==$scope.my.standard?($scope.default_startTime=$scope.default_endTime,$scope.default_endTime=new Date(new Date($scope.default_endTime).getTime()+1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),UTC_startTime=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),UTC_endTime=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:UTC_startTime,end_time:UTC_endTime,days:$scope.my.dayDiff},AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-10},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})):"Quarter"==$scope.my.standard?($scope.default_startTime=$scope.default_endTime,$scope.default_endTime=new Date(new Date($scope.default_endTime).getTime()+1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),UTC_startTime=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),UTC_endTime=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:UTC_startTime,end_time:UTC_endTime,days:$scope.my.dayDiff},AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);
                for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorQuarterDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorQuarterDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})):"HalfYear"==$scope.my.standard?($scope.default_startTime=$scope.default_endTime,$scope.default_endTime=new Date(new Date($scope.default_endTime).getTime()+1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),UTC_startTime=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),UTC_endTime=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:UTC_startTime,end_time:UTC_endTime,days:$scope.my.dayDiff},AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);
                for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorHalfYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorHalfYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})):($scope.default_startTime=$scope.default_endTime,$scope.default_endTime=new Date(new Date($scope.default_endTime).getTime()+1e3*60*60*$scope.my.timeDiff).Format("yyyy-MM-dd hh:mm:ss"),UTC_startTime=$scope.format(new Date($scope.default_startTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),UTC_endTime=$scope.format(new Date($scope.default_endTime).toUTCString(),"yyyy-MM-dd HH:mm:ss"),a={region_guid:regionId,gateway_id:gatewayId,size:$scope.my.pointDiff,start_time:UTC_startTime,end_time:UTC_endTime,days:$scope.my.dayDiff},AuthService.myHttp(token,a,"GET","recipe/sensorAndRecipeRecords").then(function(a){function l(a){dataBase.transaction(function(b){b.executeSql(h[a],[],function(b,c){function e(a){var b={table_device_guid:$scope.device_guid,device_name:"",gateway_id:gatewayId,start_time:$scope.format(new Date(j[a]+" 00:00:00").toUTCString(),"yyyy-MM-dd HH:mm:ss"),end_time:$scope.format(new Date(j[a]+" 23:59:59").toUTCString(),"yyyy-MM-dd HH:mm:ss")};$scope.getSensorDataProm=AuthService.myHttp(token,b,"GET","sensor/sensorOneDay").then(function(b){var c,d,f,g,h,i,k,l,m,n;if("0"==b.code){for($scope.message=Math.round(100*((a+1)/$scope.vm.total)),c=[],d=[],f=[],g=[],h=[],i=[],k=[],l=[],m=0;m<b.content.time.length;m++)d[m]=new Date(b.content.time[m]),c[m]=d[m].getTime(),c[m]-=1e3*60*(new Date).getTimezoneOffset(),c[m]=new Date(c[m]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.quarterObject.time.length;n++)f[n]=new Date(b.content.quarterObject.time[n]),i[n]=f[n].getTime(),i[n]-=1e3*60*(new Date).getTimezoneOffset(),i[n]=new Date(i[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.halfYearObject.time.length;n++)g[n]=new Date(b.content.halfYearObject.time[n]),k[n]=g[n].getTime(),k[n]-=1e3*60*(new Date).getTimezoneOffset(),k[n]=new Date(k[n]).Format("yyyy-MM-dd hh:mm:ss");for(n=0;n<b.content.yearObject.time.length;n++)h[n]=new Date(b.content.yearObject.time[n]),l[n]=h[n].getTime(),l[n]-=1e3*60*(new Date).getTimezoneOffset(),l[n]=new Date(l[n]).Format("yyyy-MM-dd hh:mm:ss");if(dataBase.transaction(function(a){var d,e,f,g,h,j,m,n;for(d=0;d<b.content.time.length;d++)e="INSERT INTO sensorDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+c[d]+"','"+b.content.data[0].original_data[d]+"','"+b.content.data[0].data[d]+"'"+",'"+b.content.data[1].original_data[d]+"','"+b.content.data[1].data[d]+"','"+b.content.data[2].original_data[d]+"','"+b.content.data[2].data[d]+"','"+b.content.data[3].original_data[d]+"','"+b.content.data[3].data[d]+"'"+",'"+b.content.data[4].original_data[d]+"','"+b.content.data[4].data[d]+"','"+b.content.data[5].original_data[d]+"','"+b.content.data[5].data[d]+"','"+b.content.data[6].original_data[d]+"','"+b.content.data[6].data[d]+"'"+",'"+b.content.data[7].original_data[d]+"','"+b.content.data[7].data[d]+"','"+b.content.data[8].original_data[d]+"','"+b.content.data[8].data[d]+"','"+b.content.data[9].original_data[d]+"','"+b.content.data[9].data[d]+"'"+",'"+b.content.data[10].original_data[d]+"','"+b.content.data[10].data[d]+"','"+b.content.data[11].original_data[d]+"','"+b.content.data[11].data[d]+"','"+b.content.data[12].original_data[d]+"','"+b.content.data[12].data[d]+"'"+",'"+b.content.data[13].original_data[d]+"','"+b.content.data[13].data[d]+"')",a.executeSql(e);for(f=0;f<b.content.quarterObject.time.length;f++)g="INSERT INTO sensorQuarterDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+i[f]+"','"+b.content.quarterObject.data[0].original_data[f]+"','"+b.content.quarterObject.data[0].data[f]+"'"+",'"+b.content.quarterObject.data[1].original_data[f]+"','"+b.content.quarterObject.data[1].data[f]+"','"+b.content.quarterObject.data[2].original_data[f]+"','"+b.content.quarterObject.data[2].data[f]+"','"+b.content.quarterObject.data[3].original_data[f]+"','"+b.content.quarterObject.data[3].data[f]+"'"+",'"+b.content.quarterObject.data[4].original_data[f]+"','"+b.content.quarterObject.data[4].data[f]+"','"+b.content.quarterObject.data[5].original_data[f]+"','"+b.content.quarterObject.data[5].data[f]+"','"+b.content.quarterObject.data[6].original_data[f]+"','"+b.content.quarterObject.data[6].data[f]+"'"+",'"+b.content.quarterObject.data[7].original_data[f]+"','"+b.content.quarterObject.data[7].data[f]+"','"+b.content.quarterObject.data[8].original_data[f]+"','"+b.content.quarterObject.data[8].data[f]+"','"+b.content.quarterObject.data[9].original_data[f]+"','"+b.content.quarterObject.data[9].data[f]+"'"+",'"+b.content.quarterObject.data[10].original_data[f]+"','"+b.content.quarterObject.data[10].data[f]+"','"+b.content.quarterObject.data[11].original_data[f]+"','"+b.content.quarterObject.data[11].data[f]+"','"+b.content.quarterObject.data[12].original_data[f]+"','"+b.content.quarterObject.data[12].data[f]+"'"+",'"+b.content.quarterObject.data[13].original_data[f]+"','"+b.content.quarterObject.data[13].data[f]+"')",a.executeSql(g);for(h=0;h<b.content.quarterObject.time.length;h++)j="INSERT INTO sensorHalfYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+k[h]+"','"+b.content.halfYearObject.data[0].original_data[h]+"','"+b.content.halfYearObject.data[0].data[h]+"'"+",'"+b.content.halfYearObject.data[1].original_data[h]+"','"+b.content.halfYearObject.data[1].data[h]+"','"+b.content.halfYearObject.data[2].original_data[h]+"','"+b.content.halfYearObject.data[2].data[h]+"','"+b.content.halfYearObject.data[3].original_data[h]+"','"+b.content.halfYearObject.data[3].data[h]+"'"+",'"+b.content.halfYearObject.data[4].original_data[h]+"','"+b.content.halfYearObject.data[4].data[h]+"','"+b.content.halfYearObject.data[5].original_data[h]+"','"+b.content.halfYearObject.data[5].data[h]+"','"+b.content.halfYearObject.data[6].original_data[h]+"','"+b.content.halfYearObject.data[6].data[h]+"'"+",'"+b.content.halfYearObject.data[7].original_data[h]+"','"+b.content.halfYearObject.data[7].data[h]+"','"+b.content.halfYearObject.data[8].original_data[h]+"','"+b.content.halfYearObject.data[8].data[h]+"','"+b.content.halfYearObject.data[9].original_data[h]+"','"+b.content.halfYearObject.data[9].data[h]+"'"+",'"+b.content.halfYearObject.data[10].original_data[h]+"','"+b.content.halfYearObject.data[10].data[h]+"','"+b.content.halfYearObject.data[11].original_data[h]+"','"+b.content.halfYearObject.data[11].data[h]+"','"+b.content.halfYearObject.data[12].original_data[h]+"','"+b.content.halfYearObject.data[12].data[h]+"'"+",'"+b.content.halfYearObject.data[13].original_data[h]+"','"+b.content.halfYearObject.data[13].data[h]+"')",a.executeSql(j);for(m=0;m<b.content.yearObject.time.length;m++)n="INSERT INTO sensorYearDataTable(device_guid,time,Carbon_Dioxide_original,Carbon_Dioxide,Substrate_PH_original,Substrate_PH,Substrate_Conductivity_original,Substrate_Conductivity,Substrate_Temperature_original,Substrate_Temperature,Air_Temperature_original,Air_Temperature,Ppfd_original,Ppfd,Liquid_PH_original,Liquid_PH,Substrate_Humidity_original,Substrate_Humidity,Liquid_DOC_original,Liquid_DOC,Liquid_Conductivity_original,Liquid_Conductivity,Air_Humidity_original,Air_Humidity,Substrate_DOC_original,Substrate_DOC,Illuminance_original,Illuminance,Lai_original,Lai) values ('"+$scope.device_guid+"','"+l[m]+"','"+b.content.yearObject.data[0].original_data[m]+"','"+b.content.yearObject.data[0].data[m]+"'"+",'"+b.content.yearObject.data[1].original_data[m]+"','"+b.content.yearObject.data[1].data[m]+"','"+b.content.yearObject.data[2].original_data[m]+"','"+b.content.yearObject.data[2].data[m]+"','"+b.content.yearObject.data[3].original_data[m]+"','"+b.content.yearObject.data[3].data[m]+"'"+",'"+b.content.yearObject.data[4].original_data[m]+"','"+b.content.yearObject.data[4].data[m]+"','"+b.content.yearObject.data[5].original_data[m]+"','"+b.content.yearObject.data[5].data[m]+"','"+b.content.yearObject.data[6].original_data[m]+"','"+b.content.yearObject.data[6].data[m]+"'"+",'"+b.content.yearObject.data[7].original_data[m]+"','"+b.content.yearObject.data[7].data[m]+"','"+b.content.yearObject.data[8].original_data[m]+"','"+b.content.yearObject.data[8].data[m]+"','"+b.content.yearObject.data[9].original_data[m]+"','"+b.content.yearObject.data[9].data[m]+"'"+",'"+b.content.yearObject.data[10].original_data[m]+"','"+b.content.yearObject.data[10].data[m]+"','"+b.content.yearObject.data[11].original_data[m]+"','"+b.content.yearObject.data[11].data[m]+"','"+b.content.yearObject.data[12].original_data[m]+"','"+b.content.yearObject.data[12].data[m]+"'"+",'"+b.content.yearObject.data[13].original_data[m]+"','"+b.content.yearObject.data[13].data[m]+"')",a.executeSql(n)}),a+1!=j.length)return $timeout(function(){e(a+1)},1500);a+1==j.length&&(toaster.pop({type:"success",title:"Success",body:"Download successfully , please waiting...",timeout:POPTIMEOUT}),dataBase.transaction(function(a){var b="SELECT * FROM sensorYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));
            r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})}))}else toaster.pop({type:"error",title:"Error",body:b.message,timeout:POPTIMEOUT})})}if(0==c.rows.length&&j.push(h[a].substring(54,64)),a+1!=f.length)return $timeout(function(){l(a+1)},1);if(j&&j.length>0){$scope.delay=0,$scope.minDuration=0,$scope.message="0",$scope.backdrop=!1,$scope.promise=null,$scope.templateUrl="./pages/recipedetaildown-loading-template.html",$scope.vm={},$scope.vm.total=j.length;var d=0;e(d)}else j&&0!=j.length||dataBase.transaction(function(a){var b="SELECT * FROM sensorYearDataTable WHERE time BETWEEN'"+$scope.default_startTime+"' AND '"+$scope.default_endTime+"' AND device_guid = '"+$scope.device_guid+"' ORDER BY time";a.executeSql(b,[],function(a,b){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[];if(b)for(q=0;q<b.rows.length;q++)c.push(parseFloat(b.rows[q].Carbon_Dioxide_original)),d.push(parseFloat(b.rows[q].Substrate_PH_original)),e.push(parseFloat(b.rows[q].Substrate_Conductivity_original)),f.push(parseFloat(b.rows[q].Substrate_Temperature_original)),g.push(parseFloat(b.rows[q].Air_Temperature_original)),h.push(parseFloat(b.rows[q].Ppfd_original)),i.push(parseFloat(b.rows[q].Liquid_PH_original)),j.push(parseFloat(b.rows[q].Substrate_Humidity_original)),k.push(parseFloat(b.rows[q].Liquid_DOC_original)),l.push(parseFloat(b.rows[q].Liquid_Conductivity_original)),m.push(parseFloat(b.rows[q].Air_Humidity_original)),n.push(parseFloat(b.rows[q].Substrate_DOC_original)),o.push(parseFloat(b.rows[q].Illuminance_original)),p.push(parseFloat(b.rows[q].Lai_original));r={data:c,name:"sensorData"},s={data:d,name:"sensorData"},t={data:e,name:"sensorData"},u={data:f,name:"sensorData"},v={data:g,name:"sensorData"},w={data:h,name:"sensorData"},x={data:i,name:"sensorData"},y={data:j,name:"sensorData"},z={data:k,name:"sensorData"},A={data:l,name:"sensorData"},B={data:n,name:"sensorData"},C={data:m,name:"sensorData"},D={data:o,name:"sensorData"},E={data:p,name:"sensorData"},$scope.recipeAndSensorData.data[0].data.push(r),$scope.recipeAndSensorData.data[1].data.push(s),$scope.recipeAndSensorData.data[2].data.push(t),$scope.recipeAndSensorData.data[3].data.push(u),$scope.recipeAndSensorData.data[4].data.push(v),$scope.recipeAndSensorData.data[5].data.push(w),$scope.recipeAndSensorData.data[6].data.push(x),$scope.recipeAndSensorData.data[7].data.push(y),$scope.recipeAndSensorData.data[8].data.push(z),$scope.recipeAndSensorData.data[9].data.push(A),$scope.recipeAndSensorData.data[10].data.push(B),$scope.recipeAndSensorData.data[11].data.push(C),$scope.recipeAndSensorData.data[12].data.push(D),$scope.recipeAndSensorData.data[13].data.push(E),$("#container1").highcharts({title:{text:$scope.recipeAndSensorData.data[0].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[0].data}),$("#container2").highcharts({title:{text:$scope.recipeAndSensorData.data[1].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[1].data}),$("#container3").highcharts({title:{text:$scope.recipeAndSensorData.data[2].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[2].data}),$("#container4").highcharts({title:{text:$scope.recipeAndSensorData.data[3].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[3].data}),$("#container5").highcharts({title:{text:$scope.recipeAndSensorData.data[4].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[4].data}),$("#container6").highcharts({title:{text:$scope.recipeAndSensorData.data[5].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[5].data}),$("#container7").highcharts({title:{text:$scope.recipeAndSensorData.data[6].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[6].data}),$("#container8").highcharts({title:{text:$scope.recipeAndSensorData.data[7].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[7].data}),$("#container9").highcharts({title:{text:$scope.recipeAndSensorData.data[8].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[8].data}),$("#container10").highcharts({title:{text:$scope.recipeAndSensorData.data[9].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[9].data}),$("#container11").highcharts({title:{text:$scope.recipeAndSensorData.data[10].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[10].data}),$("#container12").highcharts({title:{text:$scope.recipeAndSensorData.data[11].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[11].data}),$("#container13").highcharts({title:{text:$scope.recipeAndSensorData.data[12].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[12].data}),$("#container14").highcharts({title:{text:$scope.recipeAndSensorData.data[13].name+" data",x:-20},subtitle:{text:"",x:-20},xAxis:{categories:$scope.recipeAndSensorData.time,tickInterval:$scope.recipeAndSensorData.time.length-2},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{valueSuffix:"",valueDecimals:3},legend:{align:"center",verticalAlign:"bottom"},exporting:{enabled:!1},series:$scope.recipeAndSensorData.data[13].data})})})})})}var b,c,d,e,f,g,h,i,j,k;if("0"==a.code){for($scope.recipeAndSensorData=a.content,b=0;b<$scope.recipeAndSensorData.time.length;b++)$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).getTime(),$scope.recipeAndSensorData.time[b]-=1e3*60*(new Date).getTimezoneOffset(),$scope.recipeAndSensorData.time[b]=new Date($scope.recipeAndSensorData.time[b]).Format("yyyy-MM-dd hh:mm:ss");for(c=$scope.default_startTime.substring(0,10),d=$scope.default_endTime.substring(0,10),e=DateDiff(c,d)+1,f=[],g=0;e>g;g++)f[g]=getNewDay(c,g);for(h=[],i=0;i<f.length;i++)h[i]="SELECT * FROM sensorYearDataTable WHERE time BETWEEN '"+f[i]+" 00:00:00"+"' AND '"+f[i]+" 23:59:59"+"' AND device_guid = '"+$scope.device_guid+"'";j=[],k=0,l(k)}else toaster.pop({type:"error",title:"Error",body:a.message,timeout:POPTIMEOUT})})))};
    };

    $scope.closeRecipeDetail = function () {$scope.recipeDetail = false;}
})
